"use strict";(self["webpackChunkshopping_front_end"]=self["webpackChunkshopping_front_end"]||[]).push([[843],{3843:function(t,r,c){c.r(r),c.d(r,{default:function(){return Q}});var a=c(6252);const e={class:"container py-5"},o=(0,a._)("h1",{class:"mt-5"}," 購物車 ",-1);function n(t,r,c,n,i,s){const l=(0,a.up)("nav-tabs"),u=(0,a.up)("cart-detail");return(0,a.wg)(),(0,a.iD)("div",e,[(0,a.Wm)(l),o,(0,a.Wm)(u)])}var i=c(2958),s=c(3577);const l=t=>((0,a.dD)("data-v-31f9c24c"),t=t(),(0,a.Cn)(),t),u={class:"table table-bordered"},d=l((()=>(0,a._)("thead",{class:"thead-dark"},[(0,a._)("tr",null,[(0,a._)("th",{scope:"col"},"#"),(0,a._)("th",{scope:"col"},"商品名稱"),(0,a._)("th",{scope:"col"},"商品價格"),(0,a._)("th",{scope:"col"},"數量"),(0,a._)("th",{scope:"col",width:"300"},"總價")])],-1))),p={key:0},_=l((()=>(0,a._)("td",{colspan:"4",class:"text-center"},"購物車是空的",-1))),y=[_],C={scope:"row"},w=["onClick"],h=["onClick"],f=["onClick"],v=l((()=>(0,a._)("td",{colspan:"4",class:"text-left"},"購物車總和：",-1)));function k(t,r,c,e,o,n){return(0,a.wg)(),(0,a.iD)(a.HY,null,[(0,a._)("table",u,[d,(0,a._)("tbody",null,[e.cart&&e.cart.CartProducts&&0===e.cart.CartProducts.length?((0,a.wg)(),(0,a.iD)("tr",p,y)):(0,a.kq)("",!0),((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(e.cart.CartProducts,(t=>((0,a.wg)(),(0,a.iD)("tr",{key:t.id},[(0,a._)("th",C,(0,s.zw)(t.Product.id),1),(0,a._)("td",null,(0,s.zw)(t.Product.name),1),(0,a._)("td",null,(0,s.zw)(t.Product.price),1),(0,a._)("td",null,[(0,a._)("button",{onClick:r=>e.decreaseQuantity(t)},"-",8,w),(0,a.Uk)(" "+(0,s.zw)(t.quantity)+" ",1),(0,a._)("button",{onClick:r=>e.increaseQuantity(t)},"+",8,h)]),(0,a._)("td",null,[(0,a.Uk)((0,s.zw)(t.Product.price*t.quantity)+" ",1),(0,a._)("button",{onClick:r=>e.removeFromCart(t.Product.id)},"刪除",8,f)])])))),128))]),(0,a._)("tfoot",null,[(0,a._)("tr",null,[v,(0,a._)("td",null,(0,s.zw)(e.totalPrice),1)])])]),(0,a._)("button",{onClick:r[0]||(r[0]=(...t)=>e.postOrder&&e.postOrder(...t))},"下單")],64)}var P=c(2262),b=c(3086),g=c(2863),m={postOrders(){return g.l.post("/orders")}},q={setup(){const t=(0,P.iH)({CartProducts:[]}),r=async()=>{try{const{data:r}=await b.Z.getCart();console.log(r),t.value=r.cart}catch(r){g.F.fire({icon:"error",title:"無法取得購物車資訊，請稍後再試"})}},c=async t=>{t.quantity++,await o(t)},e=async t=>{t.quantity>1&&(t.quantity--,await o(t))},o=async t=>{try{await b.Z.updateCart({productId:t.Product.id,quantity:t.quantity}),r()}catch(c){g.F.fire({icon:"error",title:"更新購物車時出錯，請稍後再試"})}},n=async t=>{try{await b.Z.deleteCartProduct({productId:t}),r(),g.F.fire({icon:"success",title:"商品已從購物車中移除"})}catch(c){g.F.fire({icon:"error",title:"刪除商品時出錯，請稍後再試"})}},i=async()=>{try{await m.postOrders(),t.value={},g.F.fire({icon:"success",title:"下單成功"})}catch(r){g.F.fire({icon:"error",title:"下單時出錯，請稍後再試"})}},s=(0,a.Fl)((()=>t.value.CartProducts?t.value.CartProducts.reduce(((t,r)=>t+r.Product.price*r.quantity),0):0));return(0,a.bv)((async()=>{t.value={CartProducts:[]},await r()})),{cart:t,totalPrice:s,increaseQuantity:c,decreaseQuantity:e,removeFromCart:n,postOrder:i}}},F=c(3744);const D=(0,F.Z)(q,[["render",k],["__scopeId","data-v-31f9c24c"]]);var Z=D,z=(0,a.aZ)({components:{NavTabs:i.Z,CartDetail:Z}});const O=(0,F.Z)(z,[["render",n]]);var Q=O}}]);
//# sourceMappingURL=843.a96c0e4a.js.map