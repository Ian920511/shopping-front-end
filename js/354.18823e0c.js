"use strict";(self["webpackChunkshopping_front_end"]=self["webpackChunkshopping_front_end"]||[]).push([[354],{8496:function(e,t,r){r.d(t,{Z:function(){return E}});var o=r(6252),a=r(9963),n=r(3577);const i={class:"form-group"},c=(0,o._)("label",{for:"name"},"Name",-1),l={class:"form-group"},s=(0,o._)("label",{for:"categoryId"},"Category",-1),u=(0,o._)("option",{value:"",selected:"",disabled:""}," --請選擇-- ",-1),d=["value"],p={class:"form-group"},m=(0,o._)("label",{for:"price"},"Price",-1),g={class:"form-group"},f=(0,o._)("label",{for:"stock"},"Stock",-1),b={class:"form-label-group mb-3"},v=(0,o._)("label",{for:"role"},"Status",-1),h=(0,o._)("option",{value:"active"},"Active",-1),y=(0,o._)("option",{value:"inactive"},"Inactive",-1),_=[h,y],w={class:"form-group"},k=(0,o._)("label",{for:"description"},"Description",-1),I={class:"form-group"},D=(0,o._)("label",{for:"image"},"Image",-1),S=["src"],C=(0,o._)("button",{type:"submit",class:"btn btn-primary"}," 送出 ",-1);function F(e,t,r,h,y,F){return(0,o.wg)(),(0,o.iD)("form",{onSubmit:t[7]||(t[7]=(0,a.iM)(((...e)=>h.handleSubmit&&h.handleSubmit(...e)),["stop","prevent"]))},[(0,o._)("div",i,[c,(0,o.wy)((0,o._)("input",{id:"name","onUpdate:modelValue":t[0]||(t[0]=e=>h.product.name=e),type:"text",class:"form-control",name:"name",placeholder:"Enter name",required:""},null,512),[[a.nr,h.product.name]])]),(0,o._)("div",l,[s,(0,o.wy)((0,o._)("select",{id:"categoryId",class:"form-control",name:"categoryId","onUpdate:modelValue":t[1]||(t[1]=e=>h.product.categoryId=e),required:""},[u,((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(h.categories,(e=>((0,o.wg)(),(0,o.iD)("option",{key:e.id,value:e.id},(0,n.zw)(e.name),9,d)))),128))],512),[[a.bM,h.product.categoryId]])]),(0,o._)("div",p,[m,(0,o.wy)((0,o._)("input",{id:"price","onUpdate:modelValue":t[2]||(t[2]=e=>h.product.price=e),type:"number",class:"form-control",placeholder:"Enter price",name:"price"},null,512),[[a.nr,h.product.price]])]),(0,o._)("div",g,[f,(0,o.wy)((0,o._)("input",{id:"stock","onUpdate:modelValue":t[3]||(t[3]=e=>h.product.stock=e),type:"number",class:"form-control",placeholder:"Enter stock",name:"stock"},null,512),[[a.nr,h.product.stock]])]),(0,o._)("div",b,[v,(0,o.wy)((0,o._)("select",{id:"status",name:"status",class:"form-control","onUpdate:modelValue":t[4]||(t[4]=e=>h.product.status=e),required:""},_,512),[[a.bM,h.product.status]])]),(0,o._)("div",w,[k,(0,o.wy)((0,o._)("textarea",{id:"description",class:"form-control",rows:"3",name:"description","onUpdate:modelValue":t[5]||(t[5]=e=>h.product.description=e)},null,512),[[a.nr,h.product.description]])]),(0,o._)("div",I,[D,h.product.image?((0,o.wg)(),(0,o.iD)("img",{key:0,src:h.product.image,class:"d-block img-thumbnail mb-3",width:"200",height:"200"},null,8,S)):(0,o.kq)("",!0),(0,o._)("input",{id:"image",type:"file",name:"image",accept:"image/*",class:"form-control-file",onChange:t[6]||(t[6]=(...e)=>h.handleFileChange&&h.handleFileChange(...e))},null,32)]),C],32)}r(6229),r(7330),r(2062);var P=r(2262),U=r(2863),V={getCategories(){return U.l.get("/categories")}},Z={props:{initialProduct:{type:Object,default:()=>({name:"",categoryId:"",description:"",image:"",price:0,stock:0,status:""})}},setup(e,{emit:t}){const r=(0,P.iH)({...e.initialProduct}),a=(0,P.iH)([]),n=async()=>{try{const{data:e}=await V.getCategories();a.value=e}catch(e){U.F.fire({icon:"error",title:"無法獲得分類標籤，請稍後再試"})}},i=e=>{const t=e.target.files;if(0===t.length)r.value.image="";else{const e=window.URL.createObjectURL(t[0]);r.value.image=e}},c=e=>{const r=e.target,o=new FormData(r);t("after-submit",o)};return(0,o.YP)((()=>e.initialProduct),(e=>{r.value={...e}}),{deep:!0}),(0,o.bv)((()=>{n()})),{product:r,categories:a,handleFileChange:i,handleSubmit:c}}},A=r(3744);const q=(0,A.Z)(Z,[["render",F]]);var E=q},2354:function(e,t,r){r.r(t),r.d(t,{default:function(){return g}});var o=r(6252);const a={class:"container py-5"};function n(e,t,r,n,i,c){const l=(0,o.up)("ProductForm");return(0,o.wg)(),(0,o.iD)("div",a,[(0,o.Wm)(l,{onAfterSubmit:n.handleAfterSubmit,"initial-product":n.product},null,8,["onAfterSubmit","initial-product"])])}r(7658);var i=r(2262),c=r(2201),l=r(8496),s=r(1463),u=r(2863),d={components:{ProductForm:l.Z},setup(){const e=(0,i.iH)({id:-1,name:"",categoryId:"",description:"",image:"",price:0,stock:0,status:""}),t=(0,c.tv)(),r=async t=>{try{const{data:r}=await s.Z.getProduct({productId:t});e.value={...e.value,...r}}catch(r){u.F.fire({icon:"error",title:"無法取得商品資訊，請稍後再試"})}},a=async r=>{try{console.log("formData",{formData:r});for(let[e,t]of r.entries())console.log(e+": "+t);const{data:o}=await s.Z.updateProduct({productId:e.value.id,formData:r});if(console.log("data",o),t.push({name:"products"}),"error"===o.status)throw new Error(o.message)}catch(o){u.F.fire({icon:"error",title:"無法更新商品  資料，請稍後再試"})}};return(0,o.bv)((()=>{const{id:e}=t.currentRoute.value.params;r(e)})),{handleAfterSubmit:a,product:e}}},p=r(3744);const m=(0,p.Z)(d,[["render",n]]);var g=m}}]);
//# sourceMappingURL=354.18823e0c.js.map