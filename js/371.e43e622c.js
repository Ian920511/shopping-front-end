"use strict";(self["webpackChunkshopping_front_end"]=self["webpackChunkshopping_front_end"]||[]).push([[371],{8371:function(t,c,n){n.r(c),n.d(c,{default:function(){return T}});var a=n(6252);const e={class:"container py-5"},i=(0,a._)("hr",null,null,-1);function o(t,c,n,o,r,s){const l=(0,a.up)("ProductDetail");return(0,a.wg)(),(0,a.iD)("div",e,[(0,a.Wm)(l,{"initial-product":o.product},null,8,["initial-product"]),i])}var r=n(2262),s=n(2201),l=n(1463),u=n(2863),d=n(3577),p=n(9963);const m={class:"row"},y={class:"col-md-12 mb-3"},g={class:"badge badge-secondary mt-1 mb-3"},v={class:"col-lg-4"},_=["src"],b={class:"contact-info-wrap"},k={class:"list-unstyled"},w=(0,a._)("strong",{class:"h4 d-inline-block mr-2"},"Price:",-1),f={class:"h2"},h=(0,a._)("strong",{class:"h4 d-inline-block mr-2"},"Stock:",-1),C={class:"h2"},P={class:"col-lg-8"},q={class:"mb-3"},Z=["max"];function Q(t,c,n,e,i,o){const r=(0,a.up)("NavTabs");return(0,a.wg)(),(0,a.iD)(a.HY,null,[(0,a.Wm)(r),(0,a._)("div",m,[(0,a._)("div",y,[(0,a._)("h1",null,(0,d.zw)(e.product.name),1),(0,a._)("p",g,(0,d.zw)(e.product.categoryName),1)]),(0,a._)("div",v,[(0,a._)("img",{class:"img-responsive center-block",src:e.product.image,style:{width:"250px","margin-bottom":"25px"}},null,8,_),(0,a._)("div",b,[(0,a._)("ul",k,[(0,a._)("li",null,[w,(0,a._)("span",f,(0,d.zw)(e.product.price),1)]),(0,a._)("li",null,[h,(0,a._)("span",C,(0,d.zw)(e.product.stock),1)])])])]),(0,a._)("div",P,[(0,a._)("p",null,(0,d.zw)(e.product.description),1),(0,a._)("div",q,[(0,a._)("button",{onClick:c[0]||(c[0]=(...t)=>e.decreaseQuantity&&e.decreaseQuantity(...t))},"-"),(0,a.wy)((0,a._)("input",{type:"number","onUpdate:modelValue":c[1]||(c[1]=t=>e.quantity=t),min:"1",max:e.product.stock,onInput:c[2]||(c[2]=(...t)=>e.checkStock&&e.checkStock(...t))},null,40,Z),[[p.nr,e.quantity]]),(0,a._)("button",{onClick:c[3]||(c[3]=(...t)=>e.increaseQuantity&&e.increaseQuantity(...t))},"+")]),(0,a._)("button",{type:"button",class:"btn btn-primary btn-border mr-2",onClick:c[4]||(c[4]=(0,p.iM)((t=>e.addToCart(e.product.id)),["prevent","stop"]))}," 加到購物車 ")])])],64)}var z=n(3086),D=n(2958),F={name:"ProductDetail",components:{NavTabs:D.Z},props:{initialProduct:{type:Object,required:!0}},setup(t){const c=(0,r.qj)({...t.initialProduct}),n=(0,r.iH)(1),e=()=>{n.value>1&&n.value--},i=()=>{n.value<c.stock&&n.value++},o=()=>{n.value>c.stock&&(u.F.fire({icon:"warning",title:"所選數量超過庫存！"}),n.value=c.stock)};(0,a.YP)((()=>t.initialProduct),(t=>{console.log("initialProduct updated:",t),Object.assign(c,t)}));const s=async t=>{if(console.log(n.value),n.value>c.stock)u.F.fire({icon:"warning",title:"庫存不足！"});else try{const{data:c}=await z.Z.getCart(),a=c.cart.CartProducts.find((c=>c.productId===t));a?(n.value+=a.quantity,await z.Z.updateCart({productId:t,quantity:n.value})):await z.Z.postCart({productId:t,quantity:n.value}),u.F.fire({icon:"success",title:"成功加入購物車"})}catch(a){console.log(a),u.F.fire({icon:"error",title:"暫時無法加入購物車，請稍後再試"})}};return{product:c,quantity:n,addToCart:s,increaseQuantity:i,decreaseQuantity:e,checkStock:o}}},I=n(3744);const N=(0,I.Z)(F,[["render",Q]]);var j=N,x={components:{ProductDetail:j},setup(){const t=(0,r.iH)({id:-1,name:"",categoryName:"",image:"",price:-1,description:""}),c=(0,s.yj)(),n=async c=>{try{const{data:n}=await l.Z.getProduct({productId:c}),{id:a,name:e,image:i,Category:o,description:r,price:s,stock:u}=n;t.value={id:a,name:e,image:i,categoryName:o?o.name:"未分類",description:r,price:s,stock:u}}catch(n){u.F.fire({icon:"error",title:"無法取得資料，請稍後再試"})}};return(0,a.bv)((()=>{const{id:t}=c.params;n(t)})),(0,a.YP)(c,(t=>{const{id:c}=t.params;n(c)})),{product:t}}};const S=(0,I.Z)(x,[["render",o]]);var T=S}}]);
//# sourceMappingURL=371.e43e622c.js.map