{"version":3,"file":"js/843.a96c0e4a.js","mappings":"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","sources":["webpack://shopping-front-end/./src/views/UserCart.vue","webpack://shopping-front-end/./src/components/CartDetail.vue","webpack://shopping-front-end/./src/apis/order.js","webpack://shopping-front-end/./src/components/CartDetail.vue?95d9","webpack://shopping-front-end/./src/views/UserCart.vue?698a"],"sourcesContent":["<template>\r\n  <div class=\"container py-5\">\r\n    <nav-tabs />\r\n    <h1 class=\"mt-5\">\r\n      購物車\r\n    </h1>\r\n    <cart-detail />\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { defineComponent } from 'vue'\r\nimport NavTabs from './../components/NavTabs.vue'\r\nimport CartDetail from '@/components/CartDetail.vue';\r\n\r\nexport default defineComponent({\r\n  components: {\r\n    NavTabs,\r\n    CartDetail\r\n  }\r\n})\r\n</script>","<template>\r\n  <table class=\"table table-bordered\">\r\n    <thead class=\"thead-dark\">\r\n      <tr>\r\n        <th scope=\"col\">#</th>\r\n        <th scope=\"col\">商品名稱</th>\r\n        <th scope=\"col\">商品價格</th>\r\n        <th scope=\"col\">數量</th>\r\n        <th scope=\"col\" width=\"300\">總價</th> \r\n      </tr>\r\n    </thead>\r\n    <tbody>\r\n      <tr v-if=\"cart && cart.CartProducts && cart.CartProducts.length === 0\">\r\n        <td colspan=\"4\" class=\"text-center\">購物車是空的</td>\r\n      </tr>\r\n\r\n      <template v-for=\"(cartProduct) in cart.CartProducts\" :key=\"cartProduct.id\">\r\n        <tr>\r\n          <th scope=\"row\">{{ cartProduct.Product.id }}</th>\r\n          <td>{{ cartProduct.Product.name }}</td>\r\n          <td>{{ cartProduct.Product.price }}</td>\r\n          <td>\r\n            <button @click=\"decreaseQuantity(cartProduct)\">-</button>\r\n            {{ cartProduct.quantity }}\r\n            <button @click=\"increaseQuantity(cartProduct)\">+</button>\r\n          </td>\r\n          <td>\r\n            {{ cartProduct.Product.price * cartProduct.quantity }}\r\n            <button @click=\"removeFromCart(cartProduct.Product.id)\">刪除</button>\r\n          </td>\r\n          \r\n        </tr>\r\n      </template>\r\n    </tbody>\r\n    <tfoot>\r\n      <tr>\r\n        <td colspan=\"4\" class=\"text-left\">購物車總和：</td>\r\n        <td>{{ totalPrice }}</td>\r\n      </tr>\r\n    </tfoot>\r\n  </table>\r\n  <button @click=\"postOrder\">下單</button>\r\n</template>\r\n\r\n<script>\r\nimport { ref, onMounted, computed } from 'vue'\r\nimport cartAPI from './../apis/cart'\r\nimport orderAPI from './../apis/order'\r\nimport { Toast } from '@/utils/helper'\r\n\r\nexport default {\r\n  setup() {\r\n    const cart = ref({\r\n      CartProducts: []\r\n    })\r\n\r\n    const fetchCart = async () => {\r\n      try {\r\n        const { data } = await cartAPI.getCart()\r\n        console.log(data)\r\n        cart.value = data.cart\r\n      } catch (error) {\r\n        Toast.fire({\r\n          icon:'error',\r\n          title:'無法取得購物車資訊，請稍後再試'\r\n        })\r\n      }\r\n    }\r\n\r\n\r\n    const increaseQuantity = async (product) => {\r\n      product.quantity++;\r\n      await updateCartProduct(product);\r\n    }\r\n\r\n    const decreaseQuantity = async (product) => {\r\n      if (product.quantity > 1) {\r\n        product.quantity--;\r\n        await updateCartProduct(product);\r\n      }\r\n    }\r\n\r\n    const updateCartProduct = async (product) => {\r\n      try {\r\n        await cartAPI.updateCart({ productId: product.Product.id, quantity: product.quantity });\r\n        fetchCart()\r\n\r\n      } catch (error) {\r\n        Toast.fire({\r\n          icon:'error',\r\n          title:'更新購物車時出錯，請稍後再試'\r\n        })\r\n      }\r\n    }\r\n\r\n    const removeFromCart = async (productId) => {\r\n      try {\r\n        await cartAPI.deleteCartProduct({ productId });\r\n        fetchCart();\r\n        Toast.fire({\r\n          icon: 'success',\r\n          title: '商品已從購物車中移除'\r\n        });\r\n      } catch (error) {\r\n        Toast.fire({\r\n          icon: 'error',\r\n          title: '刪除商品時出錯，請稍後再試'\r\n        });\r\n      }\r\n    }\r\n\r\n    const postOrder = async () => {\r\n      try {\r\n        await orderAPI.postOrders();\r\n        cart.value = {}; \r\n        Toast.fire({\r\n          icon: 'success',\r\n          title: '下單成功'\r\n        });\r\n      } catch (error) {\r\n        Toast.fire({\r\n          icon: 'error',\r\n          title: '下單時出錯，請稍後再試'\r\n        });\r\n      }\r\n    }\r\n\r\n    const totalPrice = computed(() => {\r\n      if (!cart.value.CartProducts) {\r\n        return 0;\r\n      }\r\n      return cart.value.CartProducts.reduce((sum, product) => sum + product.Product.price * product.quantity, 0);\r\n    }) \r\n\r\n    onMounted(async () => {\r\n      cart.value = { CartProducts: [] }; \r\n      await fetchCart();\r\n    })\r\n\r\n    return {\r\n      cart,\r\n      totalPrice,\r\n      increaseQuantity,\r\n      decreaseQuantity,\r\n      removeFromCart,\r\n      postOrder\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.no-top-border {\r\n  border-top: none !important;\r\n}\r\n</style>","import { apiHelper } from \"@/utils/helper\";\r\n\r\nexport default {\r\n  postOrders () {\r\n    return apiHelper.post('/orders')\r\n  }\r\n}","import { render } from \"./CartDetail.vue?vue&type=template&id=31f9c24c&scoped=true\"\nimport script from \"./CartDetail.vue?vue&type=script&lang=js\"\nexport * from \"./CartDetail.vue?vue&type=script&lang=js\"\n\nimport \"./CartDetail.vue?vue&type=style&index=0&id=31f9c24c&scoped=true&lang=css\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-31f9c24c\"]])\n\nexport default __exports__","import { render } from \"./UserCart.vue?vue&type=template&id=c8114ac8\"\nimport script from \"./UserCart.vue?vue&type=script&lang=js\"\nexport * from \"./UserCart.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__"],"names":["class","_createElementVNode","_createElementBlock","_hoisted_1","_createVNode","_component_nav_tabs","_hoisted_2","_component_cart_detail","scope","width","colspan","_hoisted_4","$setup","cart","CartProducts","length","_hoisted_3","_hoisted_5","_Fragment","_renderList","cartProduct","id","_hoisted_6","_toDisplayString","Product","name","price","onClick","$event","decreaseQuantity","_hoisted_7","quantity","increaseQuantity","_hoisted_8","removeFromCart","_hoisted_9","_hoisted_10","totalPrice","_cache","args","postOrder","postOrders","apiHelper","post","setup","ref","fetchCart","async","data","cartAPI","getCart","console","log","value","error","Toast","fire","icon","title","product","updateCartProduct","updateCart","productId","deleteCartProduct","orderAPI","computed","reduce","sum","onMounted","__exports__","defineComponent","components","NavTabs","CartDetail","render"],"sourceRoot":""}