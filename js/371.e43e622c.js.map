{"version":3,"file":"js/371.e43e622c.js","mappings":"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","sources":["webpack://shopping-front-end/./src/views/OneProduct.vue","webpack://shopping-front-end/./src/components/ProductDetail.vue","webpack://shopping-front-end/./src/components/ProductDetail.vue?c2e8","webpack://shopping-front-end/./src/views/OneProduct.vue?a1fa"],"sourcesContent":["<template>\r\n  <div class=\"container py-5\">\r\n    <ProductDetail :initial-product=\"product\" />\r\n    <hr>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { ref, onMounted, watch } from 'vue'\r\nimport { useRoute } from 'vue-router';\r\nimport productAPI from './../apis/product'\r\nimport { Toast } from '@/utils/helper';\r\nimport ProductDetail from './../components/ProductDetail.vue'\r\n\r\nexport default {\r\n  components: {\r\n    ProductDetail\r\n  },\r\n  setup() {\r\n    const product = ref ({\r\n      id: -1,\r\n      name: '',\r\n      categoryName: '',\r\n      image: '',\r\n      price: -1,\r\n      description: '',\r\n    })\r\n\r\n    const route  = useRoute()\r\n\r\n    const fetchProduct = async (productId) => {\r\n      try {\r\n        const { data } = await productAPI.getProduct({ productId })\r\n\r\n        const { id, name, image, Category, description, price, stock } = data\r\n\r\n        product.value = {\r\n          id, name, image, categoryName: Category ? Category.name : '未分類', description, price, stock\r\n        }\r\n        \r\n      } catch (error) {\r\n        Toast.fire({\r\n          icon: 'error',\r\n          title: '無法取得資料，請稍後再試'\r\n        })\r\n      }\r\n    }\r\n\r\n    onMounted(() => {\r\n      const { id } = route.params\r\n\r\n      fetchProduct(id)\r\n    })\r\n\r\n    watch(route, (to) => {\r\n      const { id } = to.params\r\n\r\n      fetchProduct(id)\r\n    })\r\n\r\n    return {\r\n      product\r\n    }\r\n\r\n\r\n  },\r\n}\r\n</script>","<template>\r\n  <NavTabs />\r\n  <div class=\"row\">\r\n    <div class=\"col-md-12 mb-3\">\r\n      <h1>{{ product.name }}</h1>\r\n      <p class=\"badge badge-secondary mt-1 mb-3\">\r\n        {{ product.categoryName }}\r\n      </p>\r\n    </div>\r\n    <div class=\"col-lg-4\">\r\n      <img\r\n        class=\"img-responsive center-block\" \r\n        :src=\"product.image\"\r\n        style=\"width: 250px;margin-bottom: 25px;\"\r\n      >\r\n      <div class=\"contact-info-wrap\">\r\n        <ul class=\"list-unstyled\">\r\n          <li>\r\n            <strong class=\"h4 d-inline-block mr-2\">Price:</strong>\r\n            <span class=\"h2\">{{ product.price }}</span>\r\n          </li>\r\n          <li>\r\n            <strong class=\"h4 d-inline-block mr-2\">Stock:</strong>\r\n            <span class=\"h2\">{{ product.stock }}</span>\r\n          </li>\r\n        </ul>\r\n      </div>\r\n    </div>\r\n    <div class=\"col-lg-8\">\r\n      <p>{{ product.description }}</p>\r\n\r\n      <div class=\"mb-3\">\r\n        <button @click=\"decreaseQuantity\">-</button>\r\n        <input \r\n          type=\"number\" \r\n          v-model=\"quantity\" \r\n          min=\"1\" \r\n          :max=\"product.stock\" \r\n          @input=\"checkStock\"\r\n        >\r\n        <button @click=\"increaseQuantity\">+</button>\r\n      </div>\r\n\r\n      <button\r\n        type=\"button\"\r\n        class=\"btn btn-primary btn-border mr-2\"\r\n        @click.prevent.stop='addToCart(product.id)'\r\n      >\r\n        加到購物車\r\n      </button>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\n  import { reactive, watch, ref } from 'vue'\r\n  import { Toast } from './../utils/helper'\r\n  import cartAPI from './../apis/cart'\r\n  import NavTabs from './../components/NavTabs.vue'\r\n\r\n  export default {\r\n  name: 'ProductDetail',\r\n  components: {\r\n    NavTabs,\r\n  },\r\n  props: {\r\n    initialProduct: {\r\n      type: Object,\r\n      required: true\r\n    }\r\n  },\r\n  setup(props) {\r\n    const product = reactive({ ...props.initialProduct })\r\n    const quantity = ref(1)\r\n\r\n    const decreaseQuantity = () => {\r\n        if(quantity.value > 1) quantity.value--\r\n      }\r\n\r\n    const increaseQuantity = () => {\r\n        if(quantity.value < product.stock) quantity.value++\r\n      }\r\n    const checkStock = () => {\r\n        if (quantity.value > product.stock) {\r\n          Toast.fire({\r\n            icon: 'warning',\r\n            title: '所選數量超過庫存！'\r\n          })\r\n          quantity.value = product.stock\r\n        }\r\n      }\r\n\r\n    watch(() => props.initialProduct, (newValue) => {\r\n      console.log(\"initialProduct updated:\", newValue);\r\n      Object.assign(product, newValue)\r\n    })\r\n\r\n    const addToCart = async (productId) => {\r\n      console.log(quantity.value)\r\n\r\n\r\n      if (quantity.value > product.stock) {\r\n          Toast.fire({\r\n            icon:'warning',\r\n            title:'庫存不足！'\r\n          })\r\n          return\r\n        }\r\n      try {\r\n        const { data } = await cartAPI.getCart()\r\n        const existItem = data.cart.CartProducts.find(item => item.productId === productId)\r\n\r\n        if (existItem) {\r\n          quantity.value += existItem.quantity\r\n          await cartAPI.updateCart({ productId, quantity: quantity.value })\r\n        } else {\r\n          await cartAPI.postCart({ productId, quantity: quantity.value })\r\n        }\r\n\r\n        Toast.fire({\r\n          icon:'success',\r\n          title: '成功加入購物車'\r\n        })\r\n\r\n\r\n      } catch (error) {\r\n        console.log(error)\r\n        Toast.fire({\r\n          icon:'error',\r\n          title: '暫時無法加入購物車，請稍後再試'\r\n        })\r\n      }\r\n    }\r\n\r\n    return {\r\n      product,\r\n      quantity,\r\n      addToCart,\r\n      increaseQuantity,\r\n      decreaseQuantity,\r\n      checkStock\r\n    }\r\n  }\r\n}\r\n\r\n</script>","import { render } from \"./ProductDetail.vue?vue&type=template&id=1be89ba7\"\nimport script from \"./ProductDetail.vue?vue&type=script&lang=js\"\nexport * from \"./ProductDetail.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__","import { render } from \"./OneProduct.vue?vue&type=template&id=0a4ed64a\"\nimport script from \"./OneProduct.vue?vue&type=script&lang=js\"\nexport * from \"./OneProduct.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__"],"names":["class","_createElementVNode","_createElementBlock","_hoisted_1","_createVNode","_component_ProductDetail","$setup","product","_hoisted_2","_component_NavTabs","_toDisplayString","name","_hoisted_3","categoryName","_hoisted_4","src","image","style","_hoisted_6","_hoisted_7","_hoisted_8","_hoisted_9","price","_hoisted_10","_hoisted_11","stock","_hoisted_12","description","_hoisted_13","onClick","_cache","args","decreaseQuantity","type","quantity","$event","min","max","onInput","checkStock","increaseQuantity","_withModifiers","addToCart","id","components","NavTabs","props","initialProduct","Object","required","setup","reactive","ref","value","Toast","fire","icon","title","watch","newValue","console","log","assign","async","data","cartAPI","getCart","existItem","cart","CartProducts","find","item","productId","updateCart","postCart","error","__exports__","ProductDetail","route","useRoute","fetchProduct","productAPI","getProduct","Category","onMounted","params","to","render"],"sourceRoot":""}