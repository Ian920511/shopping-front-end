{"version":3,"file":"js/556.c0f616fa.js","mappings":"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","sources":["webpack://shopping-front-end/./src/views/UserProfile.vue","webpack://shopping-front-end/./src/views/UserProfile.vue?5f8e"],"sourcesContent":["<template>\r\n  <div class=\"container py-5\">\r\n    <nav-tabs />\r\n    <h1 class=\"mt-5\">\r\n      使用者資訊\r\n    </h1>\r\n    <form class=\"w-100\" @submit.stop.prevent=\"handleSubmit\">\r\n      <div class=\"form-label-group mb-2\">\r\n        <label for=\"name\">Name</label>\r\n        <input\r\n          id=\"name\"\r\n          v-model= \"name\"\r\n          name=\"name\"\r\n          type=\"text\"\r\n          class=\"form-control\"\r\n          placeholder=\"name\"\r\n          autocomplete=\"username\"\r\n          required\r\n          autofocus\r\n        >\r\n      </div>\r\n\r\n      <div class=\"form-label-group mb-2\">\r\n        <label for=\"account\">Account</label>\r\n        <input\r\n          id=\"account\"\r\n          v-model= \"account\"\r\n          name=\"account\"\r\n          type=\"text\"\r\n          class=\"form-control\"\r\n          placeholder=\"account\"\r\n          autocomplete=\"account\"\r\n          required\r\n          disabled\r\n        >\r\n      </div>\r\n\r\n      <div class=\"form-label-group mb-3\">\r\n        <label for=\"address\">Address</label>\r\n        <input\r\n          id=\"address\"\r\n          v-model= \"address\"\r\n          name=\"address\"\r\n          type=\"text\"\r\n          class=\"form-control\"\r\n          placeholder=\"address\"\r\n          autocomplete=\"address-level4\"\r\n          required\r\n        >\r\n      </div>\r\n\r\n      <div class=\"form-label-group mb-3\">\r\n        <label for=\"tel\">Tel</label>\r\n        <input\r\n          id=\"tel\"\r\n          v-model= \"tel\"\r\n          name=\"tel\"\r\n          type=\"text\"\r\n          class=\"form-control\"\r\n          placeholder=\"tel\"\r\n          autocomplete=\"tel\"\r\n          required\r\n        >\r\n      </div>\r\n\r\n      <button\r\n        class=\"btn btn-lg btn-primary d-block mx-auto mb-3\"\r\n        type=\"submit\"\r\n      >\r\n        Edit\r\n      </button>\r\n      <button\r\n        class=\"btn btn-lg btn-secondary d-block mx-auto mb-3\"\r\n        type=\"button\"\r\n        @click=\"handleCancel\"\r\n      >\r\n        Cancel\r\n      </button>\r\n    </form>\r\n  </div>\r\n  \r\n</template>\r\n\r\n<script>\r\nimport { defineComponent } from 'vue'\r\nimport NavTabs from './../components/NavTabs.vue'\r\nimport { ref, onMounted } from 'vue'\r\nimport { useUserStore } from './../stores/userStore'\r\nimport { Toast } from './../utils/helper'\r\nimport userAPI from './../apis/user'\r\n\r\nexport default defineComponent({\r\n  components: {\r\n    NavTabs\r\n  },\r\n  setup() {\r\n    const userStore = useUserStore()\r\n\r\n    const name = ref(userStore.currentUser.name)\r\n    const account = ref(userStore.currentUser.account)\r\n    const address = ref(userStore.currentUser.address)\r\n    const tel = ref(userStore.currentUser.tel)\r\n    const role = ref(userStore.currentUser.role)\r\n\r\n    const originalName = ref('')\r\n    const originalAddress = ref('')\r\n    const originalTel = ref('')\r\n    const originalRole = ref('')\r\n\r\n    const fetchUserProfile = async () => {\r\n      try {\r\n        const { data } = await userAPI.getUserProfile({ userId: userStore.currentUser.id })\r\n        name.value = data.name\r\n        account.value = data.account\r\n        address.value = data.address\r\n        tel.value = data.tel\r\n        role.value = data.role\r\n\r\n        originalName.value = data.name\r\n        originalAddress.value = data.address\r\n        originalTel.value = data.tel\r\n        originalRole.value = data.role\r\n\r\n      } catch (error) {\r\n        Toast.fire({\r\n          icon: 'error',\r\n          title: '獲取用戶資料失敗'\r\n        })\r\n      }\r\n    }\r\n\r\n    const handleSubmit = async () => {\r\n      try {\r\n        const userData = {\r\n          name: name.value,\r\n          address: address.value,\r\n          tel: tel.value,\r\n          role: role.value\r\n        }\r\n\r\n        const { data } = await userAPI.updateUser({ userId: userStore.currentUser.id, formData: userData })\r\n\r\n        if (data.status === 'error') {\r\n          throw new Error(data.message)\r\n        }\r\n\r\n        name.value = data.name\r\n        address.value = data.address\r\n        tel.value = data.tel\r\n        role.value = data.role\r\n\r\n        userStore.currentUser.name = name.value\r\n        userStore.currentUser.address = address.value\r\n        userStore.currentUser.tel = tel.value\r\n        userStore.currentUser.role = role.value\r\n\r\n        Toast.fire({\r\n          icon: 'success',\r\n          title: '更新用戶資料成功'\r\n        })\r\n\r\n      } catch (error) {\r\n        console.log(error)\r\n        Toast.fire({\r\n          icon: 'error',\r\n          title: error.message || '更新用戶資料失敗'\r\n        })\r\n      }\r\n    }\r\n\r\n    const handleCancel = () => {\r\n      name.value = originalName.value\r\n      address.value = originalAddress.value\r\n      tel.value = originalTel.value\r\n      role.value = originalRole.value\r\n    }\r\n\r\n    onMounted(() => {\r\n      fetchUserProfile()\r\n    })\r\n\r\n    return {\r\n      name,\r\n      account,\r\n      address,\r\n      tel,\r\n      role,\r\n      handleSubmit,\r\n      handleCancel,\r\n    }\r\n  },\r\n})\r\n</script>","import { render } from \"./UserProfile.vue?vue&type=template&id=0be2fc2a\"\nimport script from \"./UserProfile.vue?vue&type=script&lang=js\"\nexport * from \"./UserProfile.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__"],"names":["class","_createElementVNode","for","type","_createElementBlock","_hoisted_1","_createVNode","_component_nav_tabs","_hoisted_2","onSubmit","_cache","_withModifiers","args","_ctx","handleSubmit","_hoisted_3","_hoisted_4","id","name","$event","placeholder","autocomplete","required","autofocus","_hoisted_5","_hoisted_6","account","disabled","_hoisted_7","_hoisted_8","address","_hoisted_9","_hoisted_10","tel","_hoisted_11","onClick","handleCancel","defineComponent","components","NavTabs","setup","userStore","useUserStore","ref","currentUser","role","originalName","originalAddress","originalTel","originalRole","fetchUserProfile","async","data","userAPI","getUserProfile","userId","value","error","Toast","fire","icon","title","userData","updateUser","formData","status","Error","message","console","log","onMounted","__exports__","render"],"sourceRoot":""}